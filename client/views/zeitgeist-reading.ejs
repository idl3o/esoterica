<%
var css = `<style>
.reading-header {
    text-align: center;
    padding: 3rem 2rem 1rem;
}
.reading-date {
    font-size: 0.9rem;
    color: #888;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
}
.reading-title {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #00d4ff 0%, #9d4edd 50%, #00ff88 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.reading-nav-top {
    max-width: 900px;
    margin: 0 auto;
    padding: 0 2rem 1rem;
}
.reading-nav-top a {
    color: #00d4ff;
    text-decoration: none;
    font-size: 0.95rem;
}
.reading-tabs {
    display: flex;
    gap: 0;
    max-width: 900px;
    margin: 1rem auto 0;
    padding: 0 2rem;
    border-bottom: 2px solid rgba(0, 212, 255, 0.2);
}
.reading-tab {
    padding: 1rem 2rem;
    background: transparent;
    border: none;
    color: #666;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s;
    border-bottom: 3px solid transparent;
    font-family: inherit;
    letter-spacing: 0.15em;
    text-transform: uppercase;
}
.reading-tab.active {
    color: #00d4ff;
    border-bottom-color: #00d4ff;
}
.reading-tab:hover:not(.active) {
    color: #aaa;
}
.reading-content {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem;
}
.reading-panel { display: none; }
.reading-panel.active { display: block; }
.reading-content h1 { display: none; }
.reading-content h2 {
    color: #00d4ff;
    font-size: 1.6rem;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid rgba(0, 212, 255, 0.2);
}
.reading-content h3 {
    color: #9d4edd;
    font-size: 1.2rem;
    margin-top: 1.8rem;
    margin-bottom: 0.75rem;
}
.reading-content p { margin-bottom: 1rem; line-height: 1.8; }
.reading-content ul, .reading-content ol { margin: 1rem 0 1rem 1.5rem; line-height: 1.8; }
.reading-content li { margin-bottom: 0.75rem; }
.reading-content strong { color: #00ff88; }
.reading-content em { color: #c4a0e8; }
.reading-content hr { border: none; border-top: 2px solid rgba(0, 212, 255, 0.15); margin: 2.5rem 0; }
.reading-content blockquote {
    border-left: 3px solid #9d4edd;
    background: rgba(157, 78, 221, 0.05);
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    font-style: italic;
    color: #aaa;
}
.reading-content a { color: #00d4ff; text-decoration: none; border-bottom: 1px solid rgba(0, 212, 255, 0.3); }
.reading-content a:hover { color: #00ff88; border-bottom-color: #00ff88; }
.reading-nav-bottom {
    max-width: 900px;
    margin: 2rem auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.reading-nav-bottom a {
    color: #00d4ff;
    text-decoration: none;
    font-size: 0.9rem;
}
.reading-nav-bottom a:hover { color: #00ff88; }
@media (max-width: 768px) {
    .reading-title { font-size: 1.8rem; }
    .reading-tabs { padding: 0 1rem; }
    .reading-tab { padding: 0.75rem 1.25rem; font-size: 0.9rem; }
    .reading-content { padding: 1.5rem 1rem; }
}
</style>`;

var newerLink = newer
    ? '<a href="/zeitgeist/' + newer.date + '">&larr; ' + newer.displayDate + '</a>'
    : '<span></span>';
var olderLink = older
    ? '<a href="/zeitgeist/' + older.date + '">' + older.displayDate + ' &rarr;</a>'
    : '<span></span>';

var body;

if (reading.isIntegrated) {
    // New integrated format — single reading, no tabs
    body = css +
        '<div class="reading-nav-top"><a href="/zeitgeist">&larr; Archive</a></div>' +
        '<div class="reading-header">' +
        '    <div class="reading-date">' + reading.displayDate + '</div>' +
        '    <h1 class="reading-title">The Zeitgeist</h1>' +
        '</div>' +
        '<div class="reading-content">' +
        reading.zeit +
        '</div>' +
        '<div class="reading-nav-bottom">' +
        '    <div>' + olderLink + '</div>' +
        '    <div><a href="/zeitgeist" style="color: #888;">Archive</a></div>' +
        '    <div>' + newerLink + '</div>' +
        '</div>';
} else {
    // Old paired format — tabs for zeit/geist
    var geistPanel = reading.geist
        ? '<div id="panel-geist" class="reading-panel">' + reading.geist + '</div>'
        : '';

    var geistTab = reading.hasGeist
        ? '<button class="reading-tab" data-tab="geist" onclick="switchReadingTab(\'geist\')">The Geist</button>'
        : '';

    body = css +
        '<div class="reading-nav-top"><a href="/zeitgeist">&larr; Archive</a></div>' +
        '<div class="reading-header">' +
        '    <div class="reading-date">' + reading.displayDate + '</div>' +
        '    <h1 class="reading-title">The Zeitgeist</h1>' +
        '</div>' +
        '<div class="reading-tabs">' +
        '    <button class="reading-tab active" data-tab="zeit" onclick="switchReadingTab(\'zeit\')">The Zeit</button>' +
        geistTab +
        '</div>' +
        '<div class="reading-content">' +
        '    <div id="panel-zeit" class="reading-panel active">' + reading.zeit + '</div>' +
        geistPanel +
        '</div>' +
        '<div class="reading-nav-bottom">' +
        '    <div>' + olderLink + '</div>' +
        '    <div><a href="/zeitgeist" style="color: #888;">Archive</a></div>' +
        '    <div>' + newerLink + '</div>' +
        '</div>' +
        `<script>
function switchReadingTab(tab) {
    document.querySelectorAll('.reading-tab').forEach(function(t) { t.classList.remove('active'); });
    document.querySelectorAll('.reading-panel').forEach(function(p) { p.classList.remove('active'); });
    document.querySelector('[data-tab="' + tab + '"]').classList.add('active');
    document.getElementById('panel-' + tab).classList.add('active');
}
<\/script>`;
}
%>
<%- include('layout', { title: title, body: body }) %>
